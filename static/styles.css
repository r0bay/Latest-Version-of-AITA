:root{
  --gap:14px;
  --radius:16px;
  --shadow:0 3px 10px rgba(0,0,0,.08);
  --shadow-lg:0 4px 20px rgba(0,0,0,.12);
  --shadow-sm:0 1px 3px rgba(0,0,0,.1);
}

*{ box-sizing:border-box; -webkit-tap-highlight-color:transparent; }

html,body{
  margin:0; padding:0;
  background:#f7f7f7; color:#111;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
  overflow-x:hidden;
  -webkit-overflow-scrolling:touch;
  touch-action:pan-y;
}

main{ 
  max-width:900px; 
  margin:24px auto 0;
  padding:0 16px;
  padding-bottom:calc(64px + env(safe-area-inset-bottom, 0px) + 20px);
  min-height:calc(100vh - 24px);
  display:flex;
  flex-direction:column;
  -webkit-overflow-scrolling:touch;
}

/* ================= HEADER ================= */
header{ 
  display:block; 
  margin-bottom:16px;
  display:flex;
  justify-content:center;
  align-items:center;
}

.banner-container{
  width:100%;
  max-width:560px;
  margin:0 auto;
  display:flex;
  justify-content:center;
  align-items:center;
}

.banner-image{
  width:100%;
  max-width:100%;
  height:auto;
  display:block;
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  object-fit:contain;
}

/* Filters panel - removed */
.filters-panel{ display:none !important; }
.filters-row{ display:none !important; }

/* ================= CARD ================= */
.card{
  background:#fff; border-radius:var(--radius);
  box-shadow:0 2px 12px rgba(0,0,0,.08); border:1px solid #e8e8e8;
  padding:20px; max-width:560px; margin:0 auto;
  display:flex; flex-direction:column;
  flex:1 1 auto;
  min-height:0;
  transition:all .3s cubic-bezier(0.4, 0, 0.2, 1);
  border-bottom-left-radius:0;
  border-bottom-right-radius:0;
  margin-bottom:0;
  touch-action:pan-y;
}
.card:hover{ 
  box-shadow:0 6px 20px rgba(0,0,0,.12);
  border-color:#d0d0d0;
}

h2{ font-size:1.25rem; margin:0 0 8px; line-height:1.3; }

/* Story text area - no nested scrolling, let page scroll naturally */
.body{
  flex:1 1 auto; overflow:visible; line-height:1.55;
  white-space:pre-wrap; padding-right:6px; margin-top:6px;
  font-size:var(--body-text-size, 16px);
}

.meta{ color:#666; font-size:.9rem; margin-top:10px; text-align:center; }

/* ================= VERDICT ================= */
.verdict{
  display:none; text-align:center; font-weight:700;
  font-size:1.25rem; padding:12px 14px; border-radius:12px;
  margin:10px 0 12px; transition:all .25s ease;
}
.verdict.v-nta{ display:block; background:#e9f7ef; color:#1b5e20; }
.verdict.v-yta{ display:block; background:#ffe5e5; color:#b71c1c; }
.verdict.v-esh{ display:block; background:#fff4e5; color:#8d4e00; }
.verdict.v-none{ display:block; background:#f1f1f1; color:#444; }

/* ================= VOTE ================= */
.vote{
  display:flex; flex-direction:column; gap:10px;
  align-items:stretch; justify-content:center; margin-top:18px;
  padding:4px 0;
}
.vote button{
  flex:1 1 auto; padding:16px 18px; border-radius:14px;
  border:none; font-weight:600; cursor:pointer;
  font-size:1rem;
  transition:all .2s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow:0 2px 8px rgba(0,0,0,.08);
  position:relative;
  overflow:hidden;
}
.vote button:active{
  transform:scale(0.98);
}
.vote button::before{
  content:'';
  position:absolute;
  top:0; left:0; right:0; bottom:0;
  background:rgba(255,255,255,.2);
  opacity:0;
  transition:opacity .2s ease;
}
.vote button:active::before{
  opacity:1;
}
#voteYTA{ 
  background:linear-gradient(135deg, #ff6b6b 0%, #ff5252 100%);
  color:#fff;
  box-shadow:0 4px 12px rgba(255, 82, 82, .3);
}
#voteYTA:hover{ 
  box-shadow:0 6px 16px rgba(255, 82, 82, .4);
  transform:translateY(-2px);
}
#voteNTA{ 
  background:linear-gradient(135deg, #4ecdc4 0%, #26a69a 100%);
  color:#fff;
  box-shadow:0 4px 12px rgba(38, 166, 154, .3);
}
#voteNTA:hover{ 
  box-shadow:0 6px 16px rgba(38, 166, 154, .4);
  transform:translateY(-2px);
}
#voteESH{ 
  background:linear-gradient(135deg, #ffd93d 0%, #ffb300 100%);
  color:#333;
  box-shadow:0 4px 12px rgba(255, 179, 0, .3);
}
#voteESH:hover{ 
  box-shadow:0 6px 16px rgba(255, 179, 0, .4);
  transform:translateY(-2px);
}
#tally{ display:none !important; }  /* never show counts row */

/* ================= BELOW ROW - REMOVED ================= */
.below-row{ display:none !important; }

/* Legacy share UI disabled */
#shareMenu,[data-share-menu],.share-menu,.shareDropdown,.share-menu-panel{
  display:none !important; visibility:hidden !important; pointer-events:none !important;
}

/* ================= FLOATING DICE ================= */
/* Removed - now integrated into tab bar */

/* ================= DESKTOP ENHANCEMENTS ================= */
@media (min-width: 601px) {
  main {
    max-width: 700px;
    margin: 32px auto 0;
    padding: 0 24px;
  }
  
  .card {
    max-width: 100%;
    padding: 28px 32px;
    border-radius: var(--radius);
    margin-bottom: 0;
  }
  
  h2 {
    font-size: 1.4rem;
    margin-bottom: 12px;
    line-height: 1.3;
  }
  
  .body {
    font-size: 16px;
    line-height: 1.65;
    margin-top: 10px;
    max-width: 100%;
  }
  
  .vote {
    margin-top: 20px;
    gap: 10px;
  }
  
  .vote button {
    padding: 16px 20px;
    font-size: 1rem;
  }
  
  header {
    margin-bottom: 20px;
  }
  
  .banner-container {
    max-width: 100%;
  }
  
  .verdict {
    font-size: 1.3rem;
    padding: 14px 18px;
    margin: 14px 0;
  }
  
  /* Hide desktop navigation bar - use bottom bar instead */
  .desktop-nav {
    display: none !important;
  }
  
  /* Show bottom tabbar on desktop */
  .tabbar {
    display: flex !important;
    visibility: visible !important;
    opacity: 1 !important;
    pointer-events: auto !important;
  }
  
  /* Adjust main padding for bottom bar */
  main {
    padding-bottom: calc(64px + 20px);
  }
  
  /* Show panels as modals on desktop instead of bottom sheets */
  .panel {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    bottom: auto;
    max-width: 550px;
    max-height: 75vh;
    border-radius: var(--radius);
    box-shadow: 0 8px 32px rgba(0,0,0,.2);
    z-index: 1001;
    background: #fff;
  }
}

/* ================= MOBILE ================= */
@media (max-width:600px){
  main{ 
    margin:16px auto 0;
    padding-bottom:calc(60px + env(safe-area-inset-bottom, 0px) + 20px);
    min-height:calc(100vh - 16px);
  }
  .card{ 
    max-width:92vw; 
    padding:14px; 
    border-bottom-left-radius:0;
    border-bottom-right-radius:0;
  }
  .vote button{ flex:1 1 100%; padding:14px 16px; }

  header{ margin-bottom:12px; }
  .banner-image{ border-radius:12px; }
  
  /* Hide desktop nav on mobile */
  .desktop-nav {
    display: none !important;
  }
  
  .tabbar{ height:60px; }
  .panel{ bottom:60px; }
  .tab-icon{ font-size:20px; }
  .tab-label{ font-size:10px; }
  .tab-dice{ width:auto; height:100%; }
  .dice-icon{ width:80px; height:80px; }
  .tab-dice .tab-icon{ font-size:24px; }
}

/* ================= TAB BAR + PANELS ================= */
.tabbar{
  position:fixed; 
  bottom:0; 
  left:0; 
  right:0; 
  height:64px; 
  background:#fff;
  border-top:1px solid #e6e6e6; 
  display:flex; 
  justify-content:space-around; 
  align-items:center;
  padding-bottom:env(safe-area-inset-bottom, 0px);
  padding-left:env(safe-area-inset-left, 0px);
  padding-right:env(safe-area-inset-right, 0px);
  box-shadow:0 -2px 12px rgba(0,0,0,.1);
  z-index:1000;
  backdrop-filter:blur(10px);
}

/* Bottom tabbar is visible on all screen sizes */
.tab{ 
  flex:1; 
  height:100%; 
  border:0; 
  background:#fff; 
  font-weight:500;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:4px;
  padding:8px 4px;
  cursor:pointer;
  transition:all .2s cubic-bezier(0.4, 0, 0.2, 1);
  color:#666;
  font-size:11px;
  position:relative;
}
.tab:active{ 
  background:#f5f5f5;
  transform:scale(0.95);
}
.tab.active{ 
  color:#007AFF;
}
.tab.active .tab-icon{
  transform:scale(1.1);
}
.tab-icon{
  font-size:22px;
  line-height:1;
  transition:transform .2s ease;
}
.tab-label{
  font-size:10px;
  line-height:1;
  white-space:nowrap;
  font-weight:500;
}
.tab-dice{
  flex:0 0 auto;
  width:auto;
  height:100%;
  border-radius:0;
  background:transparent;
  border:none;
  box-shadow:none;
  margin:0;
  padding:8px 4px;
  display:flex;
  align-items:center;
  justify-content:center;
  transition:all .2s cubic-bezier(0.4, 0, 0.2, 1);
  position:relative;
}
.tab-dice:hover{
  transform:translateY(-2px);
  box-shadow:none;
  border-color:transparent;
}
.tab-dice .tab-icon{
  font-size:28px;
}
.dice-icon{
  width:88px;
  height:88px;
  object-fit:contain;
  display:block;
  transition:transform .2s ease;
}
.tab-dice:active{
  transform:scale(0.92) translateY(0);
  box-shadow:none;
}
.tab-dice:active .dice-icon{
  transform:rotate(90deg);
}

.panel{ 
  position:fixed; 
  left:0; 
  right:0; 
  bottom:64px;
  padding-bottom:env(safe-area-inset-bottom, 0px);
  top:0; 
  background:#fff; 
  border-top-left-radius:16px; 
  border-top-right-radius:16px; 
  box-shadow:0 -8px 24px rgba(0,0,0,.12); 
  padding:20px 16px 16px; 
  display:none; 
  overflow:auto;
  z-index:998;
}
.panel[aria-hidden="false"]{ display:block; }
.panel h3{ margin:0 0 16px; font-size:1.25rem; }
.list{ list-style:none; padding:0; margin:0; }
.list li{ padding:12px 8px; border-bottom:1px solid #eee; display:flex; justify-content:space-between; align-items:center; gap:10px; }
.list li > div{ flex:1 1 auto; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
.list button{ 
  border:1px solid #ddd; 
  background:#fff; 
  border-radius:8px; 
  padding:6px 12px; 
  cursor:pointer; 
  font-size:0.9rem; 
  white-space:nowrap;
  position:relative;
  z-index:1;
  pointer-events:auto;
}
.list button:active{ background:#f0f0f0; }
.list button:focus{ outline:2px solid #007AFF; outline-offset:2px; }
.setting-row{ padding:12px 0; border-bottom:1px solid #eee; display:flex; align-items:center; gap:12px; }
.setting-row:last-child{ border-bottom:none; }
.setting-row label{ flex:1 1 auto; display:flex; align-items:center; gap:8px; }
.setting-row input[type="range"]{ flex:1 1 auto; }
.setting-row input[type="checkbox"]{ width:20px; height:20px; }
.setting-row select{ padding:8px 12px; border:1px solid #ddd; border-radius:8px; background:#fff; flex:1 1 auto; max-width:200px; }
.setting-row button{ padding:10px 16px; border:1px solid #ddd; background:#fff; border-radius:8px; cursor:pointer; }
.setting-row button:active{ background:#f0f0f0; }
.setting-row-search{ flex-wrap:wrap; }
.settings-section-title{ 
  margin:24px 0 12px 0; 
  font-size:1rem; 
  font-weight:600; 
  color:#333; 
  padding-top:8px;
  border-top:1px solid #eee;
}
.settings-section-title:first-child{ margin-top:0; border-top:none; padding-top:0; }

/* ================= MODAL ================= */
.modal{ position:fixed; inset:0; background:rgba(0,0,0,.4); display:none; align-items:center; justify-content:center; padding:16px; }
.modal[aria-hidden="false"]{ display:flex; }
.modal-content{ background:#fff; border-radius:12px; padding:16px; width:min(560px, 92vw); box-shadow:var(--shadow); }
.modal-content textarea{ width:100%; border:1px solid #ddd; border-radius:8px; padding:8px; font-family:inherit; }
.modal-actions{ margin-top:10px; display:flex; justify-content:flex-end; gap:10px; }

